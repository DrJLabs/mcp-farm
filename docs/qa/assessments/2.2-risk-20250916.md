# Risk Profile: Story 2.2 â€” Harmonize Package Configs & Type Checks

Date: 2025-09-16
Reviewer: Quinn (Test Architect)

## Executive Summary
- Total Risks Identified: 6
- Critical Risks: 0
- High Risks: 2
- Risk Score: 80/100 (calculated)

Main exposure stems from configuration drift between the root and package scopes. A secondary risk is incomplete type-check coverage leading to false sense of safety. Operational disruption is moderate because configuration mistakes immediately cascade into tooling failures.

## Risk Distribution
- Security: 0
- Performance: 1 (0 critical)
- Data: 0
- Business: 0
- Operational: 5 (2 high)

## Detailed Risk Register

### OPS-221: Root and package Ruff configs diverge again
- Probability: High (3)
- Impact: High (3)
- Score: 9 (High)
- Description: Developers may reintroduce per-package ignores that override root baseline.
- Mitigation: Automated check comparing `ruff settings` outputs; guidance in README.
- Testing Focus: Integration command verifying same paths from repo root and package directory.

### OPS-222: Type checker misses sample MCP directory
- Probability: Medium (2)
- Impact: High (3)
- Score: 6 (High)
- Description: `tool.ty.src.include` fails to include non-package code, leaving gaps.
- Mitigation: Unit-ish audit of include list; regression test invoking ty on sample path.
- Testing Focus: Ty command run; optional script verifying config contains expected paths.

### OPS-223: Excess ignore codes hide real type errors
- Probability: Medium (2)
- Impact: Medium (2)
- Score: 4 (Medium)
- Description: Blanket ignores remain without follow-up plan.
- Mitigation: Document ignore rationale in Issue #5; create tickets for reduction.
- Testing Focus: Manual review plus automation to detect high-count suppressions.

### PERF-221: Ty execution time increases dramatically
- Probability: Low (1)
- Impact: Medium (2)
- Score: 2 (Low)
- Description: Additional directories slow type checker to unusable speeds.
- Mitigation: Cache `.venv`/`__pycache__` excludes; monitor run time in CI.
- Testing Focus: Record baseline runtime; raise alert if >5 minutes.

### OPS-224: `uv run ty check` fails in CI environment
- Probability: Medium (2)
- Impact: Medium (2)
- Score: 4 (Medium)
- Description: Ty may require environment variables or optional dependencies.
- Mitigation: Document prerequisites; add dry-run in local validation script.
- Testing Focus: Run command in workflow container (Story 2.4) once available.

### OPS-225: Issue #5 comment omitted, stakeholders unaware of residual debt
- Probability: Medium (2)
- Impact: Low (1)
- Score: 2 (Low)
- Description: Without comment, risk tracking falls through.
- Mitigation: Add acceptance criterion; SM/PO verify before closure.
- Testing Focus: Manual review of GitHub issue comment thread.

## Risk-Based Testing Strategy
- Priority 1: Integration commands verifying `ruff settings` parity and `uv run ty check` success.
- Priority 2: Audit of `tool.ty.rules` for high-count suppressions; ensure documentation captured in Issue #5.
- Priority 3: Monitor ty runtime once CI story lands; create follow-up if >5 minutes.

## Risk Acceptance Criteria
- Must Fix Before Merge: OPS-221, OPS-222.
- Can Defer With Ticket: OPS-223, OPS-224, OPS-225.

## Monitoring Requirements (post-merge optional)
- Add CI metric for ty check duration and failures.
- Revisit ignore list after two sprints to assess reduction opportunities.

## Story Hook
Risk profile: docs/qa/assessments/2.2-risk-20250916.md
